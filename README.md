# books_parser

Демонстрация работы скрипта: https://youtu.be/F1adHn7hI1w

Техническое задание:

У нас есть данные книг в листе “Входные данные” файла Books_info.xlsx:
1)	Порядковый номер
2)	Номера ISBN (ID книги)
3)	Ссылка на главное фото 
4)	Данные об их сохранности (Пустая строчка во входных данных – “отличная”; 1 – “хорошая”)
5)	Язык издания (Пустая строчка во входных данных – “Русский”; 1 – “Английский”)
6)	Штрихкод

Также у нас есть еще 3 листа этого эксель файла: «Букинистика», «Second-hand» и «без информации».

- Книги, у которых год выпуска 2011-2020 заносятся в лист «Second-hand»
- Книги, написанные в 1900-2010гг заносятся в лист «Букинистика». 
- Книги, информации о которых не было найдено или у которых не указан год издания, заносятся в лист «Без информации»

Сначала поиск книги осуществляется по «Лабиринт», если книги там нет, поиск осущ. По Books.ru. Если книга найдена в Лабиринте, на этом парсинг заканчивается.
Если информация о книге выгружена из books.ru, соответствующую ей Excel-строчку скрипт красит в красный.

Выгружаем следующие данные и заносим их в наш Excel файл: 

1)	Порядковый номер (Столб А, занести из входных данных)
2)	Название товара (столб С, то есть название книги, только название – автор книги в название не входит. В Лабиринте сперва идет автор, потом двоеточие, потом название); 
3)	Цена (Столб D, выписать цену если скидки нет или цену со скидкой если скидка есть.
4)	Цена до скидки (Столб Е, только для случая если есть скидка – выписать цену ДО скидки.
5)	Штрихкод (Столб J, занести из входных данных)
6)	Вес в граммах (столб K)
7)	Ширина, высота, длина в миллиметрах именно в этом порядке (столбы L, M, N)
8)	Ссылка на главное фото (Столб О, занести из входных данных)
9)	ISBN (Столб T, занести из входных данных)
1)	- Лабиринт:
Основной жанр книги (столб U, Я отдельным файлом вышлю соответствие жанров в Лабиринте и Озоне. В лабиринте жанры указаны в строчку через «/». Нужно идти справа и смотреть есть ли данный жанр в нашей таблице соответствия, если есть то соответствующий ему жанр Озона заносим в эксель, поиск окончен. Если такой жанр не указан, то переходим к жанру левее него и проверяем его также и так далее).

- Books.ru:
Основной жанр книги (столб U, В букс ру жанры указаны сверху в строчку. Сперва слева идет «книги», потом вторым номером слева идет жанр, он нам и нужен, его нужно внести в эксель)).
10)	Автор на обложке (столб W, нужно брать именно после обозначение «автор:», а не из названия, так как сперва должна быть указана Фамилия автора, а потом Имя. Если указано отчество, его тоже заносим в Excel. Если авторов несколько,указываем только первого)
11)	 Тип обложки (столб Y, указан в Лабиринте в разделе «Оформление». Мы указываем только «Мягкая обложка» и «Твердый переплет». Поэтому если в Лабиринте указана тип обложки «Твердая», то заносим как «Твердый переплет», «Мягкий переплет» как «Мягкая обложка». В ином случае заносим обложку как она указана в Лабиринте и выделяем эту ячейку красным цветом)
12)	 Аннотация (столб АА; то есть описание книги, при ручном копирование остается ссылка на Лабиринт, нужно чтобы ее НЕ было)
13)	 Издательство (Столб AD)
14)	 Год выпуска (столб AF, в Лабиринте указан после издательства)
15)	 Серия (Столб AG)
16)	 Количество страниц (Столб AL)
17)	 Язык издания (Столб AS, занести из входных данных согласно алгоритму указанному в входных данных: (Пустая строчка – “Русский”; 1 – “Английский”)
18)	 Сохранность (Столб AW, занести из входных данных согласно алгоритму указанному в входных данных: Пустая строчка – “отличная”; 1 – “хорошая”)

Данные, которые есть только в Лабиринте:
1.	Оригинальное название (Столб АТ, в лабиринте указано под главным названием если есть, если нет оставить поле пустым
2.	Иллюстратор (Столб DA, в лабиринте это называется «Художник», если не указан, то оставить поле пустым. Пример книги с иллюстратором: https://www.labirint.ru/books/394114/ ; пример книги без иллюстратора: https://www.labirint.ru/books/619949/ )
3.	Редактор (Столб CX)
4.	Цветные иллюстрации (столб АP, в Лабиринте информация есть при нажатие на «оформление» и там будет указано иллюстрации «Цветные» или «Черно-белые», в эксель заполняется только «да» или «нет»)

Данные, которые есть только на Books.ru:
1.	Тираж
